{% extends "base.html" %}

{% block title %}Energy Monitoring System{% endblock title %}

{% block style %}
<link rel="stylesheet" href="../static/css/stylesheet-home.css">
{% endblock style %}

{% block content %}
    <!-- Add New Button -->
    <button type="button" id="add_new_btn" class="btn rounded-pill m-4 pt-0 position-fixed top-5 end-0" 
            style="background-color: #ffab5d;" 
            data-bs-toggle="modal" 
            data-bs-target="#addNewModal">
        <span class="fs-4">+ </span><span>Add New</span>
    </button>

    <!-- Add New Model -->
    <div class="modal fade" id="addNewModal" tabindex="-1" aria-labelledby="addNewModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content rounded-5 bg-warning-subtle">
                <div class="modal-header">
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body text-center">
                    <a href="#" data-bs-toggle="modal" data-bs-target="#newCompanyModal" class="add-new-option rounded">
                        <h5 class="mb-0">New Company</h5>
                    </a>
                    <a href="#" data-bs-toggle="modal" data-bs-target="#newEquipmentModal" class="add-new-option rounded">
                        <h5 class="mb-0">New Equipment</h5>
                    </a>
                    <a href="#" data-bs-toggle="modal" data-bs-target="#newOperatorModal" class="add-new-option rounded">
                        <h5 class="mb-0">New Operator</h5>
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- New Company Modal -->
    <div class="modal fade" id="newCompanyModal" tabindex="-1" aria-labelledby="newCompanyModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content border-0 shadow rounded-4">
                <div class="modal-header" style="background-color: #ffab5d; color: #442c12;">
                    <h5 class="modal-title" id="newCompanyModalLabel">Add New Company</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" style="filter: invert(1);"></button>
                </div>
                <div class="modal-body" style="background-color: #fcdbbc; color: #442c12;">
                    <form action="/company" method="POST">
                        <div class="mb-3">
                            <label for="CompanyName" class="form-label">Company Name</label>
                            <input type="text" class="form-control" name="CompanyName" id="CompanyName" placeholder="Enter Company Name" maxlength="30" required>
                        </div>
                        <div class="mb-3">
                            <label for="Location" class="form-label">Location</label>
                            <input type="text" class="form-control" name="Location" id="Location" placeholder="Enter Location" maxlength="30" required>
                        </div>
                        <div class="mb-3">
                            <label for="Contact" class="form-label">Contact Number</label>
                            <input type="tel" class="form-control" name="Contact" id="Contact" placeholder="Enter Contact Number" maxlength="11" required>
                        </div>
                        <div class="d-flex justify-content-end gap-2">
                            <button type="button" class="btn btn-outline-dark rounded-pill" style="background-color: #fcdbbc; color: #442c12;" data-bs-dismiss="modal">Cancel</button>
                            <button type="submit" class="btn rounded-pill" style="background-color: #ffab5d; color: #442c12;">Submit</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- New Equipment Modal -->
    <div class="modal fade" id="newEquipmentModal" tabindex="-1" aria-labelledby="newEquipmentModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content border-0 shadow rounded-4">
                <div class="modal-header" style="background-color: #ffab5d; color: #442c12;">
                    <h5 class="modal-title" id="newEquipmentModalLabel">Add New Equipment</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" style="filter: invert(1);"></button>
                </div>
                <div class="modal-body" style="background-color: #fcdbbc; color: #442c12;">
                    <form action="/equipments" method="POST">
                        <div class="mb-3">
                            <label for="EquipmentName" class="form-label">Equipment Name</label>
                            <input type="text" class="form-control" name="EquipmentName" id="EquipmentName" placeholder="Enter Equipment Name" maxlength="30" required>
                        </div>
                        <div class="mb-3">
                            <label for="PowerRating" class="form-label">Power Rating</label>
                            <input type="number" class="form-control" name="PowerRating" id="PowerRating" placeholder="Enter Power Rating" required>
                        </div>
                        <div class="mb-3">
                            <label for="ManufacturingDate" class="form-label">Manufacturing Date</label>
                            <input type="date" class="form-control" name="ManufacturingDate" id="ManufacturingDate" required>
                        </div>
                        <div class="mb-3">
                            <label for="CompanyID" class="form-label">Company ID</label>
                            <select class="form-select" name="CompanyID" id="CompanyID" required>
                                <option value="" disabled>-- Select a CompanyID --</option>
                                {% for company_id in companies %}
                                <option value="{{ company_id }}">{{ company_id }}</option>
                                {% endfor %}
                            </select>
                        </div>
                        <div class="d-flex justify-content-end gap-2">
                            <button type="button" class="btn btn-outline-dark rounded-pill" style="background-color: #fcdbbc; color: #442c12;" data-bs-dismiss="modal">Cancel</button>
                            <button type="submit" class="btn rounded-pill" style="background-color: #ffab5d; color: #442c12;">Submit</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- New Operator Modal -->
    <div class="modal fade" id="newOperatorModal" tabindex="-1" aria-labelledby="newOperatorModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content border-0 shadow rounded-4">
                <div class="modal-header" style="background-color: #ffab5d; color: #442c12;">
                    <h5 class="modal-title" id="newOperatorModalLabel">Add New Operator</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" style="filter: invert(1);"></button>
                </div>
                <div class="modal-body" style="background-color: #fcdbbc; color: #442c12;">
                    <form action="/operators" method="POST">
                        <div class="mb-3">
                            <label for="OperatorName" class="form-label">Operator Name</label>
                            <input type="text" class="form-control" name="OperatorName" id="OperatorName" placeholder="Enter Operator Name" maxlength="30" required>
                        </div>
                        <div class="mb-3">
                            <label for="Occupation" class="form-label">Occupation</label>
                            <input type="text" class="form-control" name="Occupation" id="Occupation" placeholder="Enter Occupation" maxlength="20" required>
                        </div>
                        <div class="mb-3">
                            <label for="PhoneNumber" class="form-label">Phone Number</label>
                            <input type="tel" class="form-control" name="PhoneNumber" id="PhoneNumber" placeholder="Enter Phone Number" maxlength="11" required>
                        </div>
                        <div class="mb-3">
                            <label for="CompanyID" class="form-label">Company ID</label>
                            <select class="form-select" name="CompanyID" id="CompanyID" required>
                                <option value="" disabled>-- Select a CompanyID --</option>
                                {% for company_id in companies %}
                                <option value="{{ company_id }}">{{ company_id }}</option>
                                {% endfor %}
                            </select>
                        </div>
                        <div class="d-flex justify-content-end gap-2">
                            <button type="button" class="btn btn-outline-dark rounded-pill" style="background-color: #fcdbbc; color: #442c12;" data-bs-dismiss="modal">Cancel</button>
                            <button type="submit" class="btn rounded-pill" style="background-color: #ffab5d; color: #442c12;">Submit</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Equipment Usage Modal -->
    <div class="modal fade" id="equipmentUsageModal" tabindex="-1" aria-labelledby="equipmentUsageModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content border-0 shadow rounded-4">
                <div class="modal-header" style="background-color: #ffab5d; color: #442c12;">
                    <h5 class="modal-title" id="equipmentUsageModalLabel">Log Usage: <span id="equipmentNameSpan"></span></h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" style="filter: invert(1);"></button>
                </div>
                <div class="modal-body" style="background-color: #fcdbbc; color: #442c12;">
                    <form id="equipmentUsageForm" action="" method="POST">
                        <div class="mb-3">
                            <label for="OperatorID" class="form-label">Operator</label>
                            <select class="form-select" name="OperatorID" id="OperatorID" required>
                                <option value="" disabled>-- Select an Operator --</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="EnergyConsumed" class="form-label">Energy Consumed</label>
                            <input type="text" class="form-control" name="EnergyConsumed" id="EnergyConsumed" placeholder="Enter Energy Consumed" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Time Stamp</label>
                            <p class="form-control-plaintext" id="timeStamp"></p>
                        </div>
                        <div class="d-flex justify-content-end gap-2">
                            <button type="button" class="btn btn-outline-dark rounded-pill" style="background-color: #fcdbbc; color: #442c12;" data-bs-dismiss="modal">Cancel</button>
                            <button type="submit" class="btn rounded-pill" style="background-color: #ffab5d; color: #442c12;">Submit</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Equipment Logs Modal -->
    <div class="modal fade" id="equipmentLogsModal" tabindex="-1" aria-labelledby="equipmentLogsModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content border-0 shadow rounded-4">
                <div class="modal-header" style="background-color: #ffab5d; color: #442c12;">
                    <h5 class="modal-title" id="equipmentLogsModalLabel">Equipment Usage Logs</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" style="filter: invert(1);"></button>
                </div>
                <div class="modal-body" style="background-color: #fcdbbc; color: #442c12;">
                    <div class="table-container">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Equipment Name</th>
                                    <th>Operator Name</th>
                                    <th>Energy Consumed</th>
                                    <th>Time Stamp</th>
                                </tr>
                            </thead>
                            <tbody id="logsTableBody"></tbody>
                        </table>
                    </div>
                </div>
                <div class="modal-footer" style="background-color: #fcdbbc;">
                    <button type="button" class="btn btn-outline-dark rounded-pill" style="background-color: #fcdbbc; color: #442c12;" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="main-container" id="mainContainer">
        <div class="options-grid row justify-content-center my-5 py-5 text-center" id="optionsGrid">
            <div class="option-container col-2 p-3 m-3 rounded-4" data-content="equipments">
                <img src="../static/images/logo-equipment.png" width="70%">
                <hr>
                <h4>Equipments</h4>
            </div>
            <div class="option-container col-2 p-3 m-3 rounded-4" data-content="operators">
                <img src="../static/images/logo-operator.png" width="70%">
                <hr>
                <h4>Operators</h4>
            </div>
            <div class="option-container col-2 p-3 m-3 rounded-4" data-content="energy">
                <img src="../static/images/logo-energy-usage.png" width="70%">
                <hr>
                <h4>Energy Usage</h4>
            </div>
            <div class="option-container col-2 p-3 m-3 rounded-4" data-content="companies">
                <img src="../static/images/logo-company.png" width="70%">
                <hr>
                <h4>Companies</h4>
            </div>
        </div>

        <!-- Equipment Content Area -->
        <div class="content-area" id="equipmentsContent">
            <div class="table-container">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h2>Equipment Data</h2>
                    <button 
                        type="button" 
                        id="viewLogsBtn" 
                        class="btn rounded-pill" 
                        style="background-color: #ffab5d; color: #442c12;"
                        data-bs-toggle="modal" 
                        data-bs-target="#equipmentLogsModal">
                        View Logs
                    </button>
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>Equipment ID</th>
                            <th>Equipment Name</th>
                            <th>Power Rating</th>
                            <th>Manufacturing Date</th>
                            <th>Company ID</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>

        <!-- Operators Content Area -->
        <div class="content-area" id="operatorsContent">
            <div class="table-container">
                <h2 class="mb-4">Operators Data</h2>
                <table>
                    <thead>
                        <tr>
                            <th>Operator ID</th>
                            <th>Operator Name</th>
                            <th>Occupation</th>
                            <th>Phone Number</th>
                            <th>Company Name</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>

        <!-- Energy Usage Content Area -->
        <div class="content-area" id="energyContent">
            <div class="table-container">
                <h2 class="mb-4">Energy Usage Data</h2>
                <table>
                    <thead>
                        <tr>
                            <th>Equipment ID</th>
                            <th>Equipment Name</th>
                            <th>Energy Consumed</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>

        <!-- Companies Content Area -->
        <div class="content-area" id="companiesContent">
            <div class="table-container">
                <h2 class="mb-4">Company Data</h2>
                <table>
                    <thead>
                        <tr>
                            <th>Company ID</th>
                            <th>Company Name</th>
                            <th>Location</th>
                            <th>Contact</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>
    </div>
{% endblock content %}

{% block scripts %}
<script src="../static/js/animate_options.js"></script>
<script src="../static/js/render_data.js"></script>
{% endblock scripts %}